<!-- File: show_feed.html -->
<!-- Author: Letitia Caspersen (letitiac@bu.edu), 2/27/2026 -->
<!-- HTML page for mini insta, showing the post feed for a profile -->

{% extends 'mini_insta/base.html' %}
{% load static %}

{% block content %}
{% for post in posts %}
<div class="post_detail">

    <div class="feed_post_header">
        <img src="{{ post.profile.profile_image_url }}" alt="Profile Image">
        <a href="{% url 'show_profile' post.profile.pk %}">@{{ post.profile.username }}</a>
        <small>{{ post.timestamp }}</small>
    </div>

    <div class="photo_grid">
        {% with post.get_all_photos as photos %}
        {% if photos %}
            {% for photo in photos %}
            <div class="photo">
                <img src="{{ photo.get_image_url }}" alt="Post Photo">
            </div>
            {% endfor %}
        {% else %}
            <img src="{% static 'mini_insta/no_image.jpg' %}" alt="No Image">
        {% endif %}
        {% endwith %}
    </div>

    {% with likes=post.get_all_like %}
    {% if likes %}
    <p class="likes_line">
        <small>Liked by <strong><a href="{% url 'show_profile' likes.0.profile.pk %}">@{{ likes.0.profile.username }}</a></strong>
        {% if likes|length > 1 %}
            and {{ likes|length|add:"-1" }} other{{ likes|length|add:"-1"|pluralize }}
        {% endif %}
        </small>
    </p>
    {% endif %}
    {% endwith %}

    <p>{{ post.caption }}</p>

    <div class="comments">
        {% for comment in post.get_all_comments %}
        <div class="comment">
            <a href="{% url 'show_profile' comment.profile.pk %}"><strong>@{{ comment.profile.username }}</strong></a>
            {{ comment.text }}
        </div>
        {% endfor %}
    </div>

</div>
{% endfor %}

{% endblock %}
